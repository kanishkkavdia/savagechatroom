{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"C:\\\\react\\\\clone\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _isAndroid = _interopRequireDefault(require(\"./isAndroid\"));\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar RecognitionManager = /*#__PURE__*/function () {\n  function RecognitionManager() {\n    _classCallCheck(this, RecognitionManager);\n\n    var BrowserSpeechRecognition = typeof window !== 'undefined' && (window.SpeechRecognition || window.webkitSpeechRecognition || window.mozSpeechRecognition || window.msSpeechRecognition || window.oSpeechRecognition);\n    this.recognition = BrowserSpeechRecognition ? new BrowserSpeechRecognition() : null;\n    this.browserSupportsSpeechRecognition = this.recognition !== null;\n    this.pauseAfterDisconnect = false;\n    this.interimTranscript = '';\n    this.finalTranscript = '';\n    this.listening = false;\n    this.subscribers = {};\n\n    this.onStopListening = function () {};\n\n    if (this.browserSupportsSpeechRecognition) {\n      this.recognition.continuous = false;\n      this.recognition.interimResults = true;\n      this.recognition.onresult = this.updateTranscript.bind(this);\n      this.recognition.onend = this.onRecognitionDisconnect.bind(this);\n    }\n\n    this.resetTranscript = this.resetTranscript.bind(this);\n    this.startListening = this.startListening.bind(this);\n    this.stopListening = this.stopListening.bind(this);\n    this.abortListening = this.abortListening.bind(this);\n\n    if ((0, _isAndroid[\"default\"])()) {\n      this.updateFinalTranscript = (0, _utils.debounce)(this.updateFinalTranscript, 250, true);\n    }\n  }\n\n  _createClass(RecognitionManager, [{\n    key: \"subscribe\",\n    value: function subscribe(id, callbacks) {\n      this.subscribers[id] = callbacks;\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe(id) {\n      delete this.subscribers[id];\n    }\n  }, {\n    key: \"emitListeningChange\",\n    value: function emitListeningChange(listening) {\n      var _this = this;\n\n      this.listening = listening;\n      Object.keys(this.subscribers).forEach(function (id) {\n        var onListeningChange = _this.subscribers[id].onListeningChange;\n        onListeningChange(listening);\n      });\n    }\n  }, {\n    key: \"emitTranscriptChange\",\n    value: function emitTranscriptChange(interimTranscript, finalTranscript) {\n      var _this2 = this;\n\n      Object.keys(this.subscribers).forEach(function (id) {\n        var onTranscriptChange = _this2.subscribers[id].onTranscriptChange;\n        onTranscriptChange(interimTranscript, finalTranscript);\n      });\n    }\n  }, {\n    key: \"emitClearTranscript\",\n    value: function emitClearTranscript() {\n      var _this3 = this;\n\n      Object.keys(this.subscribers).forEach(function (id) {\n        var onClearTranscript = _this3.subscribers[id].onClearTranscript;\n        onClearTranscript();\n      });\n    }\n  }, {\n    key: \"disconnect\",\n    value: function disconnect(disconnectType) {\n      if (this.browserSupportsSpeechRecognition && this.listening) {\n        switch (disconnectType) {\n          case 'ABORT':\n            this.pauseAfterDisconnect = true;\n            this.abort();\n            break;\n\n          case 'RESET':\n            this.pauseAfterDisconnect = false;\n            this.abort();\n            break;\n\n          case 'STOP':\n          default:\n            this.pauseAfterDisconnect = true;\n            this.stop();\n        }\n      }\n    }\n  }, {\n    key: \"onRecognitionDisconnect\",\n    value: function onRecognitionDisconnect() {\n      this.onStopListening();\n      this.listening = false;\n\n      if (this.pauseAfterDisconnect) {\n        this.emitListeningChange(false);\n      } else if (this.browserSupportsSpeechRecognition) {\n        if (this.recognition.continuous) {\n          this.startListening({\n            continuous: this.recognition.continuous\n          });\n        } else {\n          this.emitListeningChange(false);\n        }\n      }\n\n      this.pauseAfterDisconnect = false;\n    }\n  }, {\n    key: \"updateTranscript\",\n    value: function updateTranscript(event) {\n      this.interimTranscript = '';\n      this.finalTranscript = '';\n\n      for (var i = event.resultIndex; i < event.results.length; ++i) {\n        if (event.results[i].isFinal && (!(0, _isAndroid[\"default\"])() || event.results[i][0].confidence > 0)) {\n          this.updateFinalTranscript(event.results[i][0].transcript);\n        } else {\n          this.interimTranscript = (0, _utils.concatTranscripts)(this.interimTranscript, event.results[i][0].transcript);\n        }\n      }\n\n      this.emitTranscriptChange(this.interimTranscript, this.finalTranscript);\n    }\n  }, {\n    key: \"updateFinalTranscript\",\n    value: function updateFinalTranscript(newFinalTranscript) {\n      this.finalTranscript = (0, _utils.concatTranscripts)(this.finalTranscript, newFinalTranscript);\n    }\n  }, {\n    key: \"resetTranscript\",\n    value: function resetTranscript() {\n      this.disconnect('RESET');\n    }\n  }, {\n    key: \"startListening\",\n    value: function () {\n      var _startListening = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this4 = this;\n\n        var _ref,\n            _ref$continuous,\n            continuous,\n            language,\n            isContinuousChanged,\n            isLanguageChanged,\n            _args = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = _args.length > 0 && _args[0] !== undefined ? _args[0] : {}, _ref$continuous = _ref.continuous, continuous = _ref$continuous === void 0 ? false : _ref$continuous, language = _ref.language;\n\n                if (this.browserSupportsSpeechRecognition) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 3:\n                isContinuousChanged = continuous !== this.recognition.continuous;\n                isLanguageChanged = language && language !== this.recognition.lang;\n\n                if (!(isContinuousChanged || isLanguageChanged)) {\n                  _context.next = 12;\n                  break;\n                }\n\n                if (!this.listening) {\n                  _context.next = 10;\n                  break;\n                }\n\n                this.stopListening();\n                _context.next = 10;\n                return new Promise(function (resolve) {\n                  _this4.onStopListening = resolve;\n                });\n\n              case 10:\n                this.recognition.continuous = isContinuousChanged ? continuous : this.recognition.continuous;\n                this.recognition.lang = isLanguageChanged ? language : this.recognition.lang;\n\n              case 12:\n                if (!this.listening) {\n                  if (!this.recognition.continuous) {\n                    this.resetTranscript();\n                    this.emitClearTranscript();\n                  }\n\n                  try {\n                    this.start();\n                  } catch (DOMException) {// Tried to start recognition after it has already started - safe to swallow this error\n                  }\n\n                  this.emitListeningChange(true);\n                }\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function startListening() {\n        return _startListening.apply(this, arguments);\n      }\n\n      return startListening;\n    }()\n  }, {\n    key: \"abortListening\",\n    value: function abortListening() {\n      this.disconnect('ABORT');\n      this.emitListeningChange(false);\n    }\n  }, {\n    key: \"stopListening\",\n    value: function stopListening() {\n      this.disconnect('STOP');\n      this.emitListeningChange(false);\n    }\n  }, {\n    key: \"getRecognition\",\n    value: function getRecognition() {\n      return this.recognition;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      if (this.browserSupportsSpeechRecognition && !this.listening) {\n        this.recognition.start();\n        this.listening = true;\n      }\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this.browserSupportsSpeechRecognition && this.listening) {\n        this.recognition.stop();\n        this.listening = false;\n      }\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      if (this.browserSupportsSpeechRecognition && this.listening) {\n        this.recognition.abort();\n        this.listening = false;\n      }\n    }\n  }]);\n\n  return RecognitionManager;\n}();\n\nexports[\"default\"] = RecognitionManager;","map":{"version":3,"sources":["C:/react/clone/node_modules/react-speech-recognition/lib/RecognitionManager.js"],"names":["Object","defineProperty","exports","value","_isAndroid","_interopRequireDefault","require","_utils","obj","__esModule","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","prototype","RecognitionManager","BrowserSpeechRecognition","window","SpeechRecognition","webkitSpeechRecognition","mozSpeechRecognition","msSpeechRecognition","oSpeechRecognition","recognition","browserSupportsSpeechRecognition","pauseAfterDisconnect","interimTranscript","finalTranscript","listening","subscribers","onStopListening","continuous","interimResults","onresult","updateTranscript","bind","onend","onRecognitionDisconnect","resetTranscript","startListening","stopListening","abortListening","updateFinalTranscript","debounce","subscribe","id","callbacks","unsubscribe","emitListeningChange","_this","keys","forEach","onListeningChange","emitTranscriptChange","_this2","onTranscriptChange","emitClearTranscript","_this3","onClearTranscript","disconnect","disconnectType","abort","stop","event","resultIndex","results","isFinal","confidence","transcript","concatTranscripts","newFinalTranscript","_startListening","mark","_callee","_this4","_ref","_ref$continuous","language","isContinuousChanged","isLanguageChanged","_args","wrap","_callee$","_context","prev","next","abrupt","lang","start","DOMException","getRecognition"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _isAndroid = _interopRequireDefault(require(\"./isAndroid\"));\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar RecognitionManager = /*#__PURE__*/function () {\n  function RecognitionManager() {\n    _classCallCheck(this, RecognitionManager);\n\n    var BrowserSpeechRecognition = typeof window !== 'undefined' && (window.SpeechRecognition || window.webkitSpeechRecognition || window.mozSpeechRecognition || window.msSpeechRecognition || window.oSpeechRecognition);\n    this.recognition = BrowserSpeechRecognition ? new BrowserSpeechRecognition() : null;\n    this.browserSupportsSpeechRecognition = this.recognition !== null;\n    this.pauseAfterDisconnect = false;\n    this.interimTranscript = '';\n    this.finalTranscript = '';\n    this.listening = false;\n    this.subscribers = {};\n\n    this.onStopListening = function () {};\n\n    if (this.browserSupportsSpeechRecognition) {\n      this.recognition.continuous = false;\n      this.recognition.interimResults = true;\n      this.recognition.onresult = this.updateTranscript.bind(this);\n      this.recognition.onend = this.onRecognitionDisconnect.bind(this);\n    }\n\n    this.resetTranscript = this.resetTranscript.bind(this);\n    this.startListening = this.startListening.bind(this);\n    this.stopListening = this.stopListening.bind(this);\n    this.abortListening = this.abortListening.bind(this);\n\n    if ((0, _isAndroid[\"default\"])()) {\n      this.updateFinalTranscript = (0, _utils.debounce)(this.updateFinalTranscript, 250, true);\n    }\n  }\n\n  _createClass(RecognitionManager, [{\n    key: \"subscribe\",\n    value: function subscribe(id, callbacks) {\n      this.subscribers[id] = callbacks;\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe(id) {\n      delete this.subscribers[id];\n    }\n  }, {\n    key: \"emitListeningChange\",\n    value: function emitListeningChange(listening) {\n      var _this = this;\n\n      this.listening = listening;\n      Object.keys(this.subscribers).forEach(function (id) {\n        var onListeningChange = _this.subscribers[id].onListeningChange;\n        onListeningChange(listening);\n      });\n    }\n  }, {\n    key: \"emitTranscriptChange\",\n    value: function emitTranscriptChange(interimTranscript, finalTranscript) {\n      var _this2 = this;\n\n      Object.keys(this.subscribers).forEach(function (id) {\n        var onTranscriptChange = _this2.subscribers[id].onTranscriptChange;\n        onTranscriptChange(interimTranscript, finalTranscript);\n      });\n    }\n  }, {\n    key: \"emitClearTranscript\",\n    value: function emitClearTranscript() {\n      var _this3 = this;\n\n      Object.keys(this.subscribers).forEach(function (id) {\n        var onClearTranscript = _this3.subscribers[id].onClearTranscript;\n        onClearTranscript();\n      });\n    }\n  }, {\n    key: \"disconnect\",\n    value: function disconnect(disconnectType) {\n      if (this.browserSupportsSpeechRecognition && this.listening) {\n        switch (disconnectType) {\n          case 'ABORT':\n            this.pauseAfterDisconnect = true;\n            this.abort();\n            break;\n\n          case 'RESET':\n            this.pauseAfterDisconnect = false;\n            this.abort();\n            break;\n\n          case 'STOP':\n          default:\n            this.pauseAfterDisconnect = true;\n            this.stop();\n        }\n      }\n    }\n  }, {\n    key: \"onRecognitionDisconnect\",\n    value: function onRecognitionDisconnect() {\n      this.onStopListening();\n      this.listening = false;\n\n      if (this.pauseAfterDisconnect) {\n        this.emitListeningChange(false);\n      } else if (this.browserSupportsSpeechRecognition) {\n        if (this.recognition.continuous) {\n          this.startListening({\n            continuous: this.recognition.continuous\n          });\n        } else {\n          this.emitListeningChange(false);\n        }\n      }\n\n      this.pauseAfterDisconnect = false;\n    }\n  }, {\n    key: \"updateTranscript\",\n    value: function updateTranscript(event) {\n      this.interimTranscript = '';\n      this.finalTranscript = '';\n\n      for (var i = event.resultIndex; i < event.results.length; ++i) {\n        if (event.results[i].isFinal && (!(0, _isAndroid[\"default\"])() || event.results[i][0].confidence > 0)) {\n          this.updateFinalTranscript(event.results[i][0].transcript);\n        } else {\n          this.interimTranscript = (0, _utils.concatTranscripts)(this.interimTranscript, event.results[i][0].transcript);\n        }\n      }\n\n      this.emitTranscriptChange(this.interimTranscript, this.finalTranscript);\n    }\n  }, {\n    key: \"updateFinalTranscript\",\n    value: function updateFinalTranscript(newFinalTranscript) {\n      this.finalTranscript = (0, _utils.concatTranscripts)(this.finalTranscript, newFinalTranscript);\n    }\n  }, {\n    key: \"resetTranscript\",\n    value: function resetTranscript() {\n      this.disconnect('RESET');\n    }\n  }, {\n    key: \"startListening\",\n    value: function () {\n      var _startListening = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this4 = this;\n\n        var _ref,\n            _ref$continuous,\n            continuous,\n            language,\n            isContinuousChanged,\n            isLanguageChanged,\n            _args = arguments;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = _args.length > 0 && _args[0] !== undefined ? _args[0] : {}, _ref$continuous = _ref.continuous, continuous = _ref$continuous === void 0 ? false : _ref$continuous, language = _ref.language;\n\n                if (this.browserSupportsSpeechRecognition) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 3:\n                isContinuousChanged = continuous !== this.recognition.continuous;\n                isLanguageChanged = language && language !== this.recognition.lang;\n\n                if (!(isContinuousChanged || isLanguageChanged)) {\n                  _context.next = 12;\n                  break;\n                }\n\n                if (!this.listening) {\n                  _context.next = 10;\n                  break;\n                }\n\n                this.stopListening();\n                _context.next = 10;\n                return new Promise(function (resolve) {\n                  _this4.onStopListening = resolve;\n                });\n\n              case 10:\n                this.recognition.continuous = isContinuousChanged ? continuous : this.recognition.continuous;\n                this.recognition.lang = isLanguageChanged ? language : this.recognition.lang;\n\n              case 12:\n                if (!this.listening) {\n                  if (!this.recognition.continuous) {\n                    this.resetTranscript();\n                    this.emitClearTranscript();\n                  }\n\n                  try {\n                    this.start();\n                  } catch (DOMException) {// Tried to start recognition after it has already started - safe to swallow this error\n                  }\n\n                  this.emitListeningChange(true);\n                }\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function startListening() {\n        return _startListening.apply(this, arguments);\n      }\n\n      return startListening;\n    }()\n  }, {\n    key: \"abortListening\",\n    value: function abortListening() {\n      this.disconnect('ABORT');\n      this.emitListeningChange(false);\n    }\n  }, {\n    key: \"stopListening\",\n    value: function stopListening() {\n      this.disconnect('STOP');\n      this.emitListeningChange(false);\n    }\n  }, {\n    key: \"getRecognition\",\n    value: function getRecognition() {\n      return this.recognition;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      if (this.browserSupportsSpeechRecognition && !this.listening) {\n        this.recognition.start();\n        this.listening = true;\n      }\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this.browserSupportsSpeechRecognition && this.listening) {\n        this.recognition.stop();\n        this.listening = false;\n      }\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      if (this.browserSupportsSpeechRecognition && this.listening) {\n        this.recognition.abort();\n        this.listening = false;\n      }\n    }\n  }]);\n\n  return RecognitionManager;\n}();\n\nexports[\"default\"] = RecognitionManager;"]},"metadata":{},"sourceType":"script"}